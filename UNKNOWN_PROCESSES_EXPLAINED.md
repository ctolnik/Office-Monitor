# üìù –û–±—ä—è—Å–Ω–µ–Ω–∏–µ "unknown" –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

## ‚ùì –ß–¢–û –¢–ê–ö–û–ï "unknown"?

**"unknown"** - —ç—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å—ã, –∫–æ—Ç–æ—Ä—ã–µ –∞–≥–µ–Ω—Ç **–Ω–µ –º–æ–∂–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å** –∏–∑-–∑–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π Windows API.

---

## üîê –ü–û–ß–ï–ú–£ –ê–ì–ï–ù–¢ –ù–ï –ú–û–ñ–ï–¢ –ò–• –û–ü–†–ï–î–ï–õ–ò–¢–¨?

Windows **–∑–∞—â–∏—â–∞–µ—Ç** –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –æ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:

### 1. **–°–∏—Å—Ç–µ–º–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã —Å –ø–æ–≤—ã—à–µ–Ω–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏**
- `lsass.exe` (Local Security Authority Subsystem)
- `csrss.exe` (Client/Server Runtime Subsystem)
- `smss.exe` (Session Manager Subsystem)
- `services.exe` (Service Control Manager)

### 2. **–ü—Ä–æ—Ü–µ—Å—Å—ã —Å –ø—Ä–∞–≤–∞–º–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ (UAC)**
–ï—Å–ª–∏ –∞–≥–µ–Ω—Ç –∑–∞–ø—É—â–µ–Ω **–±–µ–∑ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∞**, –∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ **—Å –ø—Ä–∞–≤–∞–º–∏ –∞–¥–º–∏–Ω–∞** - –∞–≥–µ–Ω—Ç –Ω–µ –º–æ–∂–µ—Ç –µ–≥–æ –≤–∏–¥–µ—Ç—å.

**–ü—Ä–∏–º–µ—Ä—ã:**
- Task Manager (–∑–∞–ø—É—â–µ–Ω–Ω—ã–π —Å –ø—Ä–∞–≤–∞–º–∏ –∞–¥–º–∏–Ω–∞)
- Regedit
- Antivirus consoles

### 3. **–ó–∞—â–∏—â—ë–Ω–Ω—ã–µ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–æ–º –ø—Ä–æ—Ü–µ—Å—Å—ã**
- Windows Defender
- Kaspersky
- ESET NOD32
- Dr.Web

### 4. **Lock Screen –∏ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–µ—Å—Å–∏—è**
–ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å **–∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª –∫–æ–º–ø—å—é—Ç–µ—Ä** (Win+L):
- Foreground window = –∑–∞—â–∏—â—ë–Ω–Ω—ã–π —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å
- –ê–≥–µ–Ω—Ç –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ "unknown"

---

## üìä –°–ö–û–õ–¨–ö–û –í–†–ï–ú–ï–ù–ò "unknown" - –≠–¢–û –ù–û–†–ú–ê–õ–¨–ù–û?

### ‚úÖ –ù–æ—Ä–º–∞–ª—å–Ω–æ: < 5% –æ—Ç –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–Ω–æ–≥–¥–∞ –±–ª–æ–∫–∏—Ä—É–µ—Ç —ç–∫—Ä–∞–Ω
- –†–µ–¥–∫–∏–µ UAC dialogs
- –ö—Ä–∞—Ç–∫–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã

### ‚ö†Ô∏è –ú–Ω–æ–≥–æ: 10-30% –æ—Ç –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —á–∞—Å—Ç–æ –±–ª–æ–∫–∏—Ä—É–µ—Ç –∫–æ–º–ø—å—é—Ç–µ—Ä
- –ú–Ω–æ–≥–æ —Ä–∞–±–æ—Ç—ã —Å –∞–¥–º–∏–Ω—Å–∫–∏–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏
- Antivirus –∞–∫—Ç–∏–≤–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### ‚ùå –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ: > 30% –æ—Ç –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:**

1. **–ê–≥–µ–Ω—Ç –∑–∞–ø—É—â–µ–Ω –ë–ï–ó –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞**
   - –†–µ—à–µ–Ω–∏–µ: –ó–∞–ø—É—Å—Ç–∏—Ç—å –∞–≥–µ–Ω—Ç —Å –ø—Ä–∞–≤–∞–º–∏ –∞–¥–º–∏–Ω–∞

2. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å–µ—Å—Å–∏–µ–π**
   - –£–¥–∞–ª—ë–Ω–Ω—ã–π —Ä–∞–±–æ—á–∏–π —Å—Ç–æ–ª (RDP) –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω
   - –ö–æ–º–ø—å—é—Ç–µ—Ä –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω (Win+L) –±–æ–ª—å—à—É—é —á–∞—Å—Ç—å –≤—Ä–µ–º–µ–Ω–∏

3. **–ü—Ä–æ–±–ª–µ–º–∞ —Å –∞–≥–µ–Ω—Ç–æ–º**
   - –ê–≥–µ–Ω—Ç –Ω–µ –º–æ–∂–µ—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ Windows API
   - –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∞–≥–µ–Ω—Ç

---

## ‚úÖ –ß–¢–û –ú–´ –°–î–ï–õ–ê–õ–ò:

### **–§–∏–ª—å—Ç—Ä—É–µ–º "unknown" –∏–∑ –æ—Ç—á—ë—Ç–æ–≤**

**–§–∞–π–ª:** `server/database/activity_segments.go:140-143`

```go
// Skip "unknown" processes (system/protected processes that agent can't monitor)
if app.ProcessName == "unknown" || app.ProcessName == "" {
    continue
}
```

**–ü–æ—á–µ–º—É:**
1. ‚ùå –ù–µ –ø–æ–ª–µ–∑–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. ‚ùå –ù–µ–ª—å–∑—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∫ productive/unproductive
3. ‚ùå –ò—Å–∫–∞–∂–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
4. ‚úÖ –í—Ä–µ–º—è –≤—Å—ë —Ä–∞–≤–Ω–æ —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –≤ **Active/Idle/Offline**

---

## üîç –ö–ê–ö –ü–†–û–í–ï–†–ò–¢–¨ –ß–¢–û –ü–†–û–ò–°–•–û–î–ò–¢:

### –ù–∞ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ:

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ –∞–≥–µ–Ω—Ç–∞
tasklist /FI "IMAGENAME eq agent.exe" /V

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥ –∞–≥–µ–Ω—Ç–∞
notepad C:\Users\<user>\AppData\Local\Office-Monitor\agent.log

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å –∞–≥–µ–Ω—Ç —Å –ø—Ä–∞–≤–∞–º–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
# –ü–ö–ú –Ω–∞ agent.exe -> "Run as administrator"
```

### –í –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö:

```sql
-- –°–∫–æ–ª—å–∫–æ "unknown" –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –¥–µ–Ω—å
SELECT 
    count(*) as unknown_segments,
    sum(duration_sec) as unknown_duration_sec
FROM monitoring.activity_segments
WHERE process_name = 'unknown'
  AND timestamp_start > now() - INTERVAL 1 DAY;

-- –¢–æ–ø –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
SELECT 
    process_name,
    sum(duration_sec) as total_sec,
    count(*) as segments
FROM monitoring.activity_segments
WHERE timestamp_start > now() - INTERVAL 1 DAY
GROUP BY process_name
ORDER BY total_sec DESC
LIMIT 10;
```

---

## üìã –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò:

### –î–ª—è –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ "unknown":

1. **–ó–∞–ø—É—Å–∫–∞—Ç—å –∞–≥–µ–Ω—Ç —Å –ø—Ä–∞–≤–∞–º–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞**
   - –°–æ–∑–¥–∞—Ç—å scheduled task –≤ Windows
   - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å "Run with highest privileges"

2. **–î–æ–±–∞–≤–∏—Ç—å –∞–≥–µ–Ω—Ç –≤ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–∞**
   - Windows Defender: Settings -> Virus & threat protection -> Exclusions
   - –î–æ–±–∞–≤–∏—Ç—å –ø—É—Ç—å –∫ agent.exe

3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –∞–≥–µ–Ω—Ç–∞**
   - –ï—Å–ª–∏ –º–Ω–æ–≥–æ –æ—à–∏–±–æ–∫ OpenProcess - –ø—Ä–æ–±–ª–µ–º–∞ —Å –ø—Ä–∞–≤–∞–º–∏
   - –ï—Å–ª–∏ –º–Ω–æ–≥–æ –æ—à–∏–±–æ–∫ GetForegroundWindow - –ø—Ä–æ–±–ª–µ–º–∞ —Å API

---

## ‚úÖ –ò–¢–û–ì:

–ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–∞:
- ‚úÖ "unknown" –ø—Ä–æ—Ü–µ—Å—Å—ã **—Å–∫—Ä—ã—Ç—ã** –∏–∑ —Å–ø–∏—Å–∫–∞ Applications
- ‚úÖ –í—Ä–µ–º—è –≤—Å—ë —Ä–∞–≤–Ω–æ **—É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è** –≤ Active/Idle/Offline
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ **—á–∏—â–µ** –∏ –ø–æ–Ω—è—Ç–Ω–µ–µ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ –ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å **—Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è** —Ç–æ–ª—å–∫–æ –ø–æ –∏–∑–≤–µ—Å—Ç–Ω—ã–º –ø—Ä–æ—Ü–µ—Å—Å–∞–º

