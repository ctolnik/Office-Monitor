# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Frontend ‚Üî Backend

## üìã –°—Ç–∞—Ç—É—Å –ø—Ä–æ–≤–µ—Ä–∫–∏ (24.11.2025)

### ‚úÖ –ß–¢–û –ë–´–õ–û –ò–°–ü–†–ê–í–õ–ï–ù–û

#### 1. –î–æ–±–∞–≤–ª–µ–Ω GET /api/users
**–ü—Ä–æ–±–ª–µ–º–∞**: Frontend –≤—ã–∑—ã–≤–∞–ª –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π endpoint –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**–†–µ—à–µ–Ω–∏–µ**: 
- –î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `Database.GetUniqueUsernames()` –≤ `server/database/clickhouse.go`
- –î–æ–±–∞–≤–ª–µ–Ω handler `getUsersListHandler()` –≤ `server/handlers.go`
- Endpoint –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –≤ `server/main.go`

**–ß—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç**: 
```json
["user1", "user2", "user3"]
```

**–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**: Dropdown "–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ Reports/Activity

---

#### 2. –î–æ–±–∞–≤–ª–µ–Ω GET /api/settings/app-categories
**–ü—Ä–æ–±–ª–µ–º–∞**: Frontend –≤—ã–∑—ã–≤–∞–ª `/api/settings/app-categories`, –Ω–æ —Ç–∞–∫–æ–≥–æ route –Ω–µ –±—ã–ª–æ

**–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–ª–µ–Ω alias-route –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ `/api/categories`

**–ß—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç**: –°–ø–∏—Å–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π (—Ç–∞–∫–æ–π –∂–µ –∫–∞–∫ `/api/categories`)

**–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**: –ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø—Ä–æ–≥—Ä–∞–º–º

---

#### 3. –î–æ–±–∞–≤–ª–µ–Ω GET /api/activity/segments ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ù–û
**–ü—Ä–æ–±–ª–µ–º–∞**: Frontend —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç—Ä–µ–±–æ–≤–∞–ª–∞ endpoint –¥–ª—è timeline visualization, –Ω–æ –µ–≥–æ –Ω–µ –±—ã–ª–æ

**–†–µ—à–µ–Ω–∏–µ**:
- –î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `Database.GetActivitySegments()` –≤ `server/database/clickhouse.go`
- –î–æ–±–∞–≤–ª–µ–Ω handler `getActivitySegmentsHandler()` –≤ `server/handlers.go`
- Endpoint –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –≤ `server/main.go`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
- `computer_name` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π)
- `date` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π) - —Ñ–æ—Ä–º–∞—Ç `YYYY-MM-DD`, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–µ–≥–æ–¥–Ω—è

**–ß—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç**:
```typescript
interface ActivitySegment {
  timestamp_start: string;         // "2025-11-23T09:15:00Z"
  timestamp_end: string;           // "2025-11-23T09:45:00Z"
  duration_sec: number;            // 1800 (30 –º–∏–Ω)
  state: "active" | "idle" | "offline";
  process_name: string;            // "chrome.exe"
  window_title: string;            // "–ü–æ—á—Ç–∞ ‚Äî mail.yandex.ru"
  computer_name: string;           // "PC001"
  username: string;                // "ivanov"
}

type ActivitySegmentsResponse = ActivitySegment[];
```

**–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**: **Timeline chart** - –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ —á–∞—Å–∞–º –¥–Ω—è

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞**:
```http
GET /api/activity/segments?computer_name=PC001&date=2025-11-23
```

---

## üìä –ò–¢–û–ì–û–í–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê

### –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ endpoints

| –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π | –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π |
|----------------|-------------------|
| 47 endpoints   | **50 endpoints**  |

### –ß—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ

1. ‚úÖ `GET /api/users` - —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
2. ‚úÖ `GET /api/settings/app-categories` - alias –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π
3. ‚úÖ `GET /api/activity/segments` - —Å–µ–≥–º–µ–Ω—Ç—ã –¥–ª—è timeline

---

## üîç –ü–†–û–í–ï–†–ö–ê –°–û–û–¢–í–ï–¢–°–¢–í–ò–Ø –°–ü–ï–¶–ò–§–ò–ö–ê–¶–ò–ò

### –ò–∑ FRONTEND_TASK_ACTIVITY_TRACKING.md —Ç—Ä–µ–±–æ–≤–∞–ª–æ—Å—å:

| Endpoint | –°—Ç–∞—Ç—É—Å | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|----------|--------|-------------|
| `GET /api/activity/summary` | ‚úÖ | –ë—ã–ª —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Ä–∞–Ω–µ–µ |
| `GET /api/activity/segments` | ‚úÖ | **–¢–û–õ–¨–ö–û –ß–¢–û –î–û–ë–ê–í–õ–ï–ù** |
| `GET /api/process-catalog` | ‚úÖ | –ë—ã–ª —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Ä–∞–Ω–µ–µ |
| `POST /api/process-catalog` | ‚úÖ | –ë—ã–ª —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Ä–∞–Ω–µ–µ |
| `PUT /api/process-catalog/:id` | ‚úÖ | –ë—ã–ª —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Ä–∞–Ω–µ–µ |
| `DELETE /api/process-catalog/:id` | ‚úÖ | –ë—ã–ª —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Ä–∞–Ω–µ–µ |

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ –∏ –¥–æ–±–∞–≤–ª–µ–Ω–æ:

| Endpoint | –î–ª—è —á–µ–≥–æ –Ω—É–∂–µ–Ω |
|----------|----------------|
| `GET /api/users` | Dropdown —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ |
| `GET /api/settings/app-categories` | –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º |

---

## üéØ –†–ï–ó–£–õ–¨–¢–ê–¢

### ‚úÖ Backend –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ —Å Frontend

- **–í—Å–µ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ endpoints —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã**
- **Server –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫** (43MB binary)
- **50 API endpoints –¥–æ—Å—Ç—É–ø–Ω—ã**
- **–°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–ª—è lovable.dev —Å–æ–∑–¥–∞–Ω–∞**: `LOVABLE_API_SPECIFICATION.md`

### üöÄ –ß—Ç–æ –¥–µ–ª–∞—Ç—å –¥–∞–ª—å—à–µ

#### –í–∞—Ä–∏–∞–Ω—Ç 1: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–µ–∫—É—â–∏–π backend
1. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä:
   ```bash
   docker compose restart monitoring-server
   ```

2. Frontend —Å–º–æ–∂–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ endpoints:
   - ‚úÖ `/api/users` - –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
   - ‚úÖ `/api/activity/summary` - –ø–æ–ª—É—á–∏—Ç—å –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
   - ‚úÖ `/api/activity/segments` - –ø–æ–ª—É—á–∏—Ç—å —Å–µ–≥–º–µ–Ω—Ç—ã –¥–ª—è timeline
   - ‚úÖ `/api/settings/app-categories` - –ø–æ–ª—É—á–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

#### –í–∞—Ä–∏–∞–Ω—Ç 2: –î–æ—Ä–∞–±–æ—Ç–∞—Ç—å Frontend –Ω–∞ lovable.dev
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç **`LOVABLE_API_SPECIFICATION.md`** –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –Ω–∞ lovable.dev:

**–ß—Ç–æ –≤–∫–ª—é—á–µ–Ω–æ –≤ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—é**:
- üìã –ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö 50 endpoints —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏
- üìù TypeScript –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –¥–ª—è –≤—Å–µ—Ö –æ—Ç–≤–µ—Ç–æ–≤ API
- ‚ö†Ô∏è –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
- üîß –ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫
- üéØ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (MVP ‚Üí Phase 2 ‚Üí Phase 3)

**–ö—Ä–∏—Ç–∏—á–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è –¥–ª—è lovable.dev**:
1. ‚ö†Ô∏è `friendly_name` –ø–æ–∫–∞ **–≤—Å–µ–≥–¥–∞ —Ä–∞–≤–µ–Ω** `process_name` (JOIN —Å process_catalog –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω)
2. ‚ö†Ô∏è `/api/activity/summary` –º–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å **500 error** –µ—Å–ª–∏ ClickHouse views –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã
3. ‚ö†Ô∏è –ù–µ—Ç –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ - –≤—Å–µ endpoints –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –ø–æ–ª–Ω—ã–µ —Å–ø–∏—Å–∫–∏

---

## üìÑ –§–ê–ô–õ–´ –î–õ–Ø –ü–ï–†–ï–î–ê–ß–ò –ù–ê LOVABLE.DEV

### –û—Å–Ω–æ–≤–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç
- **`LOVABLE_API_SPECIFICATION.md`** - –ø–æ–ª–Ω–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è API (50 endpoints)

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- **`FRONTEND_TASK_ACTIVITY_TRACKING.md`** - –¥–µ—Ç–∞–ª—å–Ω–æ–µ –¢–ó –Ω–∞ Activity Tracking —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª
- **`FRONTEND_BACKEND_INTEGRATION.md`** - —ç—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç (summary –∏–∑–º–µ–Ω–µ–Ω–∏–π)

---

## ‚ö†Ô∏è –ò–ó–í–ï–°–¢–ù–´–ï –û–ì–†–ê–ù–ò–ß–ï–ù–ò–Ø

### 1. Friendly Names –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç
**–ü—Ä–æ–±–ª–µ–º–∞**: Backend –Ω–µ –¥–µ–ª–∞–µ—Ç JOIN –º–µ–∂–¥—É `program_usage_daily` –∏ `process_catalog`

**Impact**: –í –æ—Ç—á–µ—Ç–∞—Ö –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è `chrome.exe` –≤–º–µ—Å—Ç–æ "Google Chrome"

**–†–µ—à–µ–Ω–∏–µ**: 
- Frontend –¥–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å `process_name` –∫–∞–∫ –µ—Å—Ç—å
- –ö–æ–≥–¥–∞ backend –¥–æ–±–∞–≤–∏—Ç JOIN, –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ `friendly_name`

### 2. ClickHouse materialized views
**–ü—Ä–æ–±–ª–µ–º–∞**: Views –Ω–µ —Å–æ–∑–¥–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ

**Impact**: `/api/activity/summary` –º–æ–∂–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å 500 error

**–†–µ—à–µ–Ω–∏–µ**:
```typescript
// –û–±—Ä–∞–±–æ—Ç–∫–∞ 500 –æ—à–∏–±–∫–∏
if (response.status === 500) {
  throw new Error('DATABASE_NOT_INITIALIZED');
}

// UI –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–Ω—è—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
if (error?.message === 'DATABASE_NOT_INITIALIZED') {
  return <ErrorMessage text="–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞" />;
}
```

### 3. –ù–µ—Ç –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
**–ü—Ä–æ–±–ª–µ–º–∞**: –í—Å–µ endpoints –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –ø–æ–ª–Ω—ã–µ —Å–ø–∏—Å–∫–∏

**Impact**: –ú–µ–¥–ª–µ–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –¥–∞–Ω–Ω—ã—Ö

**–†–µ—à–µ–Ω–∏–µ**: Client-side –ø–∞–≥–∏–Ω–∞—Ü–∏—è (–ø–æ–∫–∞)

---

## ‚úÖ CHECKLIST –ì–û–¢–û–í–ù–û–°–¢–ò

- [x] GET /api/users —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
- [x] GET /api/settings/app-categories —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
- [x] GET /api/activity/segments —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
- [x] Server –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- [x] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–ª—è lovable.dev —Å–æ–∑–¥–∞–Ω–∞
- [x] –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã

---

## üéâ –ò–¢–û–ì–û

**Backend –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤ –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å Frontend!**

–í—Å–µ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ endpoints —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã. Frontend (—Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º—ã–π –Ω–∞ lovable.dev) —Ç–µ–ø–µ—Ä—å –º–æ–∂–µ—Ç:
- ‚úÖ –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è dropdown
- ‚úÖ –ü–æ–ª—É—á–∏—Ç—å –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- ‚úÖ –ü–æ–ª—É—á–∏—Ç—å —Å–µ–≥–º–µ–Ω—Ç—ã –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è timeline chart
- ‚úÖ –£–ø—Ä–∞–≤–ª—è—Ç—å —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–º –ø—Ä–æ–≥—Ä–∞–º–º (process catalog)
- ‚úÖ –ü–æ–ª—É—á–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥**: –ü–µ—Ä–µ–¥–∞—Ç—å `LOVABLE_API_SPECIFICATION.md` –∫–æ–º–∞–Ω–¥–µ frontend –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏.
